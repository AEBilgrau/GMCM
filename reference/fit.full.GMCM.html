<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Estimate GMCM parameters of the general model — fit.full.GMCM • GMCM</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Estimate GMCM parameters of the general model — fit.full.GMCM" />
<meta property="og:description" content="Estimates the parameters of general Gaussian mixture copula models (GMCM).
The function finds the maximum likelihood estimate of a general
GMCM with various optimization procedures. Note, all but the PEM methods
provides the maximum likelihood estimate." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GMCM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/AEBilgrau/GMCM">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimate GMCM parameters of the general model</h1>
    <small class="dont-index">Source: <a href='https://github.com/AEBilgrau/GMCM/blob/master/R/fit.full.GMCM.R'><code>R/fit.full.GMCM.R</code></a></small>
    <div class="hidden name"><code>fit.full.GMCM.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Estimates the parameters of general Gaussian mixture copula models (GMCM).
The function finds the maximum likelihood estimate of a general
GMCM with various optimization procedures. Note, all but the PEM methods
provides the maximum likelihood estimate.</p>
    </div>

    <pre class="usage"><span class='fu'>fit.full.GMCM</span>(<span class='no'>u</span>, <span class='no'>m</span>, <span class='kw'>theta</span> <span class='kw'>=</span> <span class='fu'><a href='choose.theta.html'>choose.theta</a></span>(<span class='no'>u</span>, <span class='no'>m</span>), <span class='kw'>method</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"NM"</span>,
  <span class='st'>"SANN"</span>, <span class='st'>"L-BFGS"</span>, <span class='st'>"L-BFGS-B"</span>, <span class='st'>"PEM"</span>), <span class='kw'>max.ite</span> <span class='kw'>=</span> <span class='fl'>1000</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='no'>...</span>)

<span class='fu'>fit.general.GMCM</span>(<span class='no'>u</span>, <span class='no'>m</span>, <span class='kw'>theta</span> <span class='kw'>=</span> <span class='fu'><a href='choose.theta.html'>choose.theta</a></span>(<span class='no'>u</span>, <span class='no'>m</span>), <span class='kw'>method</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"NM"</span>,
  <span class='st'>"SANN"</span>, <span class='st'>"L-BFGS"</span>, <span class='st'>"L-BFGS-B"</span>, <span class='st'>"PEM"</span>), <span class='kw'>max.ite</span> <span class='kw'>=</span> <span class='fl'>1000</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>u</th>
      <td><p>An <code>n</code> by <code>d</code> matrix of marginally uniform observations.
Rows corresponds to observations and columns to the dimensions of the
variables. I.e. these are often ranked and scaled test statistics or other
observations.</p></td>
    </tr>
    <tr>
      <th>m</th>
      <td><p>The number of components to be fitted.</p></td>
    </tr>
    <tr>
      <th>theta</th>
      <td><p>A list of parameters as defined in <code><a href='rtheta.html'>rtheta</a></code>. If
<code>theta</code> is not provided, then heuristic starting values are chosen
using the k-means algorithm.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>A character vector of length \(1\). The optimization
method used. Should be either <code>"NM"</code>, <code>"SANN"</code>, <code>"L-BFGS"</code>,
<code>"L-BFGS-B"</code>, or <code>"PEM"</code> which are the Nelder-Mead, Simulated
Annealing, limited-memory quasi-Newton method, limited-memory quasi-Newton
method with box constraints, and the pseudo EM algorithm, respectively.
Default is <code>"NM"</code>. See <code><a href='https://rdrr.io/r/stats/optim.html'>optim</a></code> for further details.</p></td>
    </tr>
    <tr>
      <th>max.ite</th>
      <td><p>The maximum number of iterations. If the <code>method</code> is
<code>"SANN"</code> this is the number of iterations as there is no other
stopping criterion. (See <code><a href='https://rdrr.io/r/stats/optim.html'>optim</a></code>)</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Logical. If <code>TRUE</code>, a trace of the parameter estimates
is made.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Arguments passed to the <code>control</code>-list in
<code><a href='https://rdrr.io/r/stats/optim.html'>optim</a></code> when <code>method</code> is not equal to <code>"PEM"</code>.
If <code>method</code> equals <code>"PEM"</code>, the arguments are passed to
 <code><a href='PseudoEMAlgorithm.html'>PseudoEMAlgorithm</a></code> if the <code>method</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of parameters formatted as described in <code><a href='rtheta.html'>rtheta</a></code>.</p>
<p>When <code>method</code> equals <code>"PEM"</code>, a list of extra information
(log-likelihood trace, the matrix of group probabilities, theta trace) is
added as an attribute called "extra".</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The <code>"L-BFGS-B"</code> method does not perform a transformation of
  the parameters and uses box constraints as implemented in <code>optim</code>. <br />
  Note that the many parameter configurations are poorly estimable or
  directly unidentifiable.</p>
<p><code>fit.general.GMCM</code> is simply an alias of <code>fit.full.gmcm</code>.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>All the optimization procedures are strongly dependent on the initial
  values and other parameters (such as the cooling scheme for method SANN).
  Therefore it is advisable to apply multiple
  different initial parameters (and optimization routines) and select the
  best fit.</p>
<p>The <code><a href='choose.theta.html'>choose.theta</a></code> itself chooses random a initialization.
  Hence, the output when <code>theta</code> is not directly supplied can vary.</p>
<p>See <code><a href='https://rdrr.io/r/stats/optim.html'>optim</a></code> for further details.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Li, Q., Brown, J. B. J. B., Huang, H., &amp; Bickel, P. J. (2011).
  Measuring reproducibility of high-throughput experiments. The Annals of
  Applied Statistics, 5(3), 1752-1779. doi:10.1214/11-AOAS466</p>
<p>Tewari, A., Giering, M. J., &amp; Raghunathan, A. (2011). Parametric
  Characterization of Multimodal Distributions with Non-gaussian Modes. 2011
  IEEE 11th International Conference on Data Mining Workshops, 286-292.
doi:10.1109/ICDMW.2011.135</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/r/stats/optim.html'>optim</a></code>, <code><a href='get.IDR.html'>get.prob</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>17</span>)
<span class='no'>sim</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='SimulateGMCMData.html'>SimulateGMCMData</a></span>(<span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>1000</span>, <span class='kw'>m</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>d</span> <span class='kw'>=</span> <span class='fl'>2</span>)

<span class='co'># Plotting simulated data</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>mfrow</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>))
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>sim</span>$<span class='no'>z</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/palettes.html'>rainbow</a></span>(<span class='fl'>3</span>)[<span class='no'>sim</span>$<span class='no'>K</span>], <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Latent process"</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>sim</span>$<span class='no'>u</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/palettes.html'>rainbow</a></span>(<span class='fl'>3</span>)[<span class='no'>sim</span>$<span class='no'>K</span>], <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"GMCM process"</span>)</div><div class='img'><img src='fit.full.GMCM-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Observed data</span>
<span class='no'>uhat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='Uhat.html'>Uhat</a></span>(<span class='no'>sim</span>$<span class='no'>u</span>)

<span class='co'># The model should be fitted multiple times using different starting estimates</span>
<span class='no'>start.theta</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='choose.theta.html'>choose.theta</a></span>(<span class='no'>uhat</span>, <span class='kw'>m</span> <span class='kw'>=</span> <span class='fl'>3</span>)  <span class='co'># Random starting estimate</span>
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'>fit.full.GMCM</span>(<span class='kw'>u</span> <span class='kw'>=</span> <span class='no'>uhat</span>, <span class='kw'>theta</span> <span class='kw'>=</span> <span class='no'>start.theta</span>,
                     <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"NM"</span>, <span class='kw'>max.ite</span> <span class='kw'>=</span> <span class='fl'>3000</span>,
                     <span class='kw'>reltol</span> <span class='kw'>=</span> <span class='fl'>1e-2</span>, <span class='kw'>trace</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)  <span class='co'># Note, 1e-2 is too big</span></div><div class='output co'>#&gt;   Nelder-Mead direct search function minimizer
#&gt; function value for initial parameters = -545.989357
#&gt;   Scaled convergence tolerance is 5.45999
#&gt; Stepsize computed as 0.622874
#&gt; BUILD             15 -181.364917 -607.913043
#&gt; HI-REDUCTION      17 -290.414492 -607.913043
#&gt; LO-REDUCTION      19 -381.286753 -607.913043
#&gt; LO-REDUCTION      21 -416.339626 -607.913043
#&gt; LO-REDUCTION      23 -443.287997 -607.913043
#&gt; LO-REDUCTION      25 -452.988730 -607.913043
#&gt; LO-REDUCTION      27 -473.876690 -607.913043
#&gt; HI-REDUCTION      29 -478.668822 -607.913043
#&gt; LO-REDUCTION      31 -488.164776 -607.913043
#&gt; LO-REDUCTION      33 -493.779249 -607.913043
#&gt; LO-REDUCTION      35 -497.273411 -607.913043
#&gt; EXTENSION         37 -506.928050 -637.031759
#&gt; LO-REDUCTION      39 -512.824130 -637.031759
#&gt; LO-REDUCTION      41 -540.798755 -637.031759
#&gt; LO-REDUCTION      43 -545.989357 -637.031759
#&gt; EXTENSION         45 -546.904877 -656.778752
#&gt; LO-REDUCTION      47 -554.999391 -656.778752
#&gt; LO-REDUCTION      49 -556.873829 -656.778752
#&gt; LO-REDUCTION      51 -557.207070 -656.778752
#&gt; LO-REDUCTION      53 -560.222614 -656.778752
#&gt; LO-REDUCTION      55 -563.146559 -656.778752
#&gt; LO-REDUCTION      57 -568.809552 -656.778752
#&gt; LO-REDUCTION      59 -568.822527 -656.778752
#&gt; LO-REDUCTION      61 -575.304346 -657.595173
#&gt; REFLECTION        63 -607.913043 -668.890671
#&gt; LO-REDUCTION      65 -612.881381 -668.890671
#&gt; LO-REDUCTION      67 -616.920288 -668.890671
#&gt; LO-REDUCTION      69 -623.616514 -668.890671
#&gt; LO-REDUCTION      71 -625.542742 -668.890671
#&gt; REFLECTION        73 -627.715548 -672.386340
#&gt; LO-REDUCTION      75 -632.063552 -672.386340
#&gt; LO-REDUCTION      77 -635.169773 -672.386340
#&gt; REFLECTION        79 -637.031759 -673.621224
#&gt; LO-REDUCTION      81 -638.663225 -673.621224
#&gt; REFLECTION        83 -640.500103 -673.697419
#&gt; LO-REDUCTION      85 -645.060565 -673.697419
#&gt; HI-REDUCTION      87 -652.511509 -673.697419
#&gt; REFLECTION        89 -656.404679 -676.802339
#&gt; LO-REDUCTION      91 -656.436660 -676.802339
#&gt; LO-REDUCTION      93 -656.778752 -676.802339
#&gt; LO-REDUCTION      95 -657.595173 -676.802339
#&gt; LO-REDUCTION      97 -659.660819 -676.802339
#&gt; LO-REDUCTION      99 -660.496546 -676.802339
#&gt; HI-REDUCTION     101 -661.984331 -676.802339
#&gt; HI-REDUCTION     103 -665.156366 -676.802339
#&gt; EXTENSION        105 -667.767870 -684.291294
#&gt; LO-REDUCTION     107 -668.620458 -684.291294
#&gt; HI-REDUCTION     109 -668.890671 -684.291294
#&gt; LO-REDUCTION     111 -671.932296 -684.291294
#&gt; LO-REDUCTION     113 -671.954567 -684.291294
#&gt; LO-REDUCTION     115 -672.386340 -684.291294
#&gt; LO-REDUCTION     117 -673.621224 -684.291294
#&gt; LO-REDUCTION     119 -673.697419 -684.291294
#&gt; LO-REDUCTION     121 -674.174319 -684.291294
#&gt; LO-REDUCTION     123 -674.973471 -684.291294
#&gt; LO-REDUCTION     125 -675.998553 -684.291294
#&gt; LO-REDUCTION     127 -676.128724 -684.291294
#&gt; EXTENSION        129 -676.519877 -686.571474
#&gt; LO-REDUCTION     131 -676.520928 -686.571474
#&gt; LO-REDUCTION     133 -676.802339 -686.571474
#&gt; REFLECTION       135 -677.412806 -687.371632
#&gt; LO-REDUCTION     137 -678.362967 -687.371632
#&gt; LO-REDUCTION     139 -678.883261 -687.371632
#&gt; EXTENSION        141 -679.465947 -691.973270
#&gt; LO-REDUCTION     143 -679.504612 -691.973270
#&gt; LO-REDUCTION     145 -680.614256 -691.973270
#&gt; EXTENSION        147 -680.914675 -694.673666
#&gt; EXTENSION        149 -681.813032 -699.831936
#&gt; LO-REDUCTION     151 -683.710055 -699.831936
#&gt; LO-REDUCTION     153 -683.927285 -699.831936
#&gt; LO-REDUCTION     155 -683.991374 -699.831936
#&gt; LO-REDUCTION     157 -684.193487 -699.831936
#&gt; LO-REDUCTION     159 -684.291294 -699.831936
#&gt; LO-REDUCTION     161 -686.036691 -699.831936
#&gt; EXTENSION        163 -686.136179 -702.916072
#&gt; LO-REDUCTION     165 -686.571474 -702.916072
#&gt; LO-REDUCTION     167 -687.037323 -702.916072
#&gt; EXTENSION        169 -687.371632 -710.072718
#&gt; LO-REDUCTION     171 -690.086754 -710.072718
#&gt; LO-REDUCTION     173 -691.282247 -710.072718
#&gt; LO-REDUCTION     175 -691.973270 -710.072718
#&gt; LO-REDUCTION     177 -692.700564 -710.072718
#&gt; LO-REDUCTION     179 -694.673666 -710.072718
#&gt; LO-REDUCTION     181 -695.223208 -710.072718
#&gt; LO-REDUCTION     183 -695.824834 -710.072718
#&gt; LO-REDUCTION     185 -695.943653 -710.072718
#&gt; EXTENSION        187 -696.305622 -710.735228
#&gt; HI-REDUCTION     189 -697.608363 -710.735228
#&gt; LO-REDUCTION     191 -698.479768 -710.735228
#&gt; LO-REDUCTION     193 -699.831936 -710.735228
#&gt; LO-REDUCTION     195 -700.454431 -710.735228
#&gt; REFLECTION       197 -702.028381 -711.106772
#&gt; LO-REDUCTION     199 -702.214078 -711.106772
#&gt; EXTENSION        201 -702.504380 -713.481754
#&gt; REFLECTION       203 -702.893339 -713.908167
#&gt; LO-REDUCTION     205 -702.916072 -713.908167
#&gt; EXTENSION        207 -705.647560 -721.285516
#&gt; LO-REDUCTION     209 -706.286356 -721.285516
#&gt; LO-REDUCTION     211 -707.503505 -721.285516
#&gt; LO-REDUCTION     213 -708.393078 -721.285516
#&gt; LO-REDUCTION     215 -708.465580 -721.285516
#&gt; LO-REDUCTION     217 -708.513191 -721.285516
#&gt; HI-REDUCTION     219 -709.097685 -721.285516
#&gt; LO-REDUCTION     221 -709.543836 -721.285516
#&gt; LO-REDUCTION     223 -710.072718 -721.285516
#&gt; LO-REDUCTION     225 -710.735228 -721.285516
#&gt; LO-REDUCTION     227 -711.106772 -721.285516
#&gt; EXTENSION        229 -711.220997 -721.500131
#&gt; EXTENSION        231 -713.200793 -727.220534
#&gt; LO-REDUCTION     233 -713.481754 -727.220534
#&gt; LO-REDUCTION     235 -713.908167 -727.220534
#&gt; LO-REDUCTION     237 -714.522440 -727.220534
#&gt; LO-REDUCTION     239 -716.005669 -727.220534
#&gt; LO-REDUCTION     241 -716.469917 -727.220534
#&gt; LO-REDUCTION     243 -717.046978 -727.220534
#&gt; LO-REDUCTION     245 -717.144789 -727.220534
#&gt; LO-REDUCTION     247 -717.768371 -727.220534
#&gt; LO-REDUCTION     249 -719.541861 -727.220534
#&gt; LO-REDUCTION     251 -720.028782 -727.220534
#&gt; LO-REDUCTION     253 -720.156059 -727.220534
#&gt; LO-REDUCTION     255 -720.708474 -727.220534
#&gt; EXTENSION        257 -721.285516 -728.985618
#&gt; LO-REDUCTION     259 -721.500131 -728.985618
#&gt; LO-REDUCTION     261 -721.666801 -728.985618
#&gt; LO-REDUCTION     263 -721.926602 -728.985618
#&gt; EXTENSION        265 -723.589752 -732.828018
#&gt; LO-REDUCTION     267 -724.204066 -732.828018
#&gt; LO-REDUCTION     269 -725.226211 -732.828018
#&gt; LO-REDUCTION     271 -725.235945 -732.828018
#&gt; LO-REDUCTION     273 -725.416924 -732.828018
#&gt; LO-REDUCTION     275 -725.974702 -732.828018
#&gt; LO-REDUCTION     277 -726.114174 -732.828018
#&gt; LO-REDUCTION     279 -726.903048 -732.828018
#&gt; LO-REDUCTION     281 -726.911094 -732.828018
#&gt; LO-REDUCTION     283 -727.220534 -732.828018
#&gt; LO-REDUCTION     285 -727.242634 -732.828018
#&gt; Exiting from Nelder Mead minimizer
#&gt;     287 function evaluations used</div><div class='input'>
<span class='co'># Confusion matrix</span>
<span class='no'>Khat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span>(<span class='fu'><a href='get.IDR.html'>get.prob</a></span>(<span class='no'>uhat</span>, <span class='kw'>theta</span> <span class='kw'>=</span> <span class='no'>res</span>), <span class='fl'>1</span>, <span class='no'>which.max</span>)
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span>(<span class='st'>"Khat"</span> <span class='kw'>=</span> <span class='no'>Khat</span>, <span class='st'>"K"</span> <span class='kw'>=</span> <span class='no'>sim</span>$<span class='no'>K</span>)  <span class='co'># Note, some components have been swapped</span></div><div class='output co'>#&gt;     K
#&gt; Khat   1   2   3
#&gt;    1  97 121   0
#&gt;    2   0 489   0
#&gt;    3   0   0 293</div><div class='input'>
<span class='co'># Simulation from GMCM with the fitted parameters</span>
<span class='no'>simfit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='SimulateGMCMData.html'>SimulateGMCMData</a></span>(<span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>1000</span>, <span class='kw'>theta</span> <span class='kw'>=</span> <span class='no'>res</span>)

<span class='co'># As seen, the underlying latent process is hard to estimate.</span>
<span class='co'># The clustering, however, is very good.</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>mfrow</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>,<span class='fl'>2</span>))
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>simfit</span>$<span class='no'>z</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='no'>simfit</span>$<span class='no'>K</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Model check 1\nSimulated GMM"</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>simfit</span>$<span class='no'>u</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='no'>simfit</span>$<span class='no'>K</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Model check 2\nSimulated GMCM"</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>sim</span>$<span class='no'>u</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='no'>Khat</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"MAP clustering"</span>)</div><div class='img'><img src='fit.full.GMCM-2.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#note">Note</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Anders Ellern Bilgrau &lt;anders.ellern.bilgrau@gmail.com&gt;</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Anders Ellern Bilgrau.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.9900.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


