<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Estimate GMCM parameters of the general model — fit.full.GMCM • GMCM</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Estimate GMCM parameters of the general model — fit.full.GMCM" />

<meta property="og:description" content="Estimates the parameters of general Gaussian mixture copula models (GMCM).
The function finds the maximum likelihood estimate of a general
GMCM with various optimization procedures. Note, all but the PEM methods
provides the maximum likelihood estimate." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GMCM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/AEBilgrau/GMCM">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimate GMCM parameters of the general model</h1>
    <small class="dont-index">Source: <a href='https://github.com/AEBilgrau/GMCM/blob/master/R/fit.full.GMCM.R'><code>R/fit.full.GMCM.R</code></a></small>
    <div class="hidden name"><code>fit.full.GMCM.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Estimates the parameters of general Gaussian mixture copula models (GMCM).
The function finds the maximum likelihood estimate of a general
GMCM with various optimization procedures. Note, all but the PEM methods
provides the maximum likelihood estimate.</p>
    
    </div>

    <pre class="usage"><span class='fu'>fit.full.GMCM</span>(<span class='no'>u</span>, <span class='no'>m</span>, <span class='kw'>theta</span> <span class='kw'>=</span> <span class='fu'><a href='choose.theta.html'>choose.theta</a></span>(<span class='no'>u</span>, <span class='no'>m</span>), <span class='kw'>method</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"NM"</span>,
  <span class='st'>"SANN"</span>, <span class='st'>"L-BFGS"</span>, <span class='st'>"L-BFGS-B"</span>, <span class='st'>"PEM"</span>), <span class='kw'>max.ite</span> <span class='kw'>=</span> <span class='fl'>1000</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='no'>...</span>)

<span class='fu'>fit.general.GMCM</span>(<span class='no'>u</span>, <span class='no'>m</span>, <span class='kw'>theta</span> <span class='kw'>=</span> <span class='fu'><a href='choose.theta.html'>choose.theta</a></span>(<span class='no'>u</span>, <span class='no'>m</span>), <span class='kw'>method</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"NM"</span>,
  <span class='st'>"SANN"</span>, <span class='st'>"L-BFGS"</span>, <span class='st'>"L-BFGS-B"</span>, <span class='st'>"PEM"</span>), <span class='kw'>max.ite</span> <span class='kw'>=</span> <span class='fl'>1000</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>u</th>
      <td><p>An <code>n</code> by <code>d</code> matrix of marginally uniform observations.
Rows corresponds to observations and columns to the dimensions of the
variables. I.e. these are often ranked and scaled test statistics or other
observations.</p></td>
    </tr>
    <tr>
      <th>m</th>
      <td><p>The number of components to be fitted.</p></td>
    </tr>
    <tr>
      <th>theta</th>
      <td><p>A list of parameters as defined in <code><a href='rtheta.html'>rtheta</a></code>. If
<code>theta</code> is not provided, then heuristic starting values are chosen
using the k-means algorithm.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>A character vector of length \(1\). The optimization
method used. Should be either <code>"NM"</code>, <code>"SANN"</code>, <code>"L-BFGS"</code>,
<code>"L-BFGS-B"</code>, or <code>"PEM"</code> which are the Nelder-Mead, Simulated
Annealing, limited-memory quasi-Newton method, limited-memory quasi-Newton
method with box constraints, and the pseudo EM algorithm, respectively.
Default is <code>"NM"</code>. See <code><a href='https://rdrr.io/r/stats/optim.html'>optim</a></code> for further details.</p></td>
    </tr>
    <tr>
      <th>max.ite</th>
      <td><p>The maximum number of iterations. If the <code>method</code> is
<code>"SANN"</code> this is the number of iterations as there is no other
stopping criterion. (See <code><a href='https://rdrr.io/r/stats/optim.html'>optim</a></code>)</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Logical. If <code>TRUE</code>, a trace of the parameter estimates
is made.</p></td>
    </tr>
    <tr>
      <th>&#8230;</th>
      <td><p>Arguments passed to the <code>control</code>-list in
<code><a href='https://rdrr.io/r/stats/optim.html'>optim</a></code> when <code>method</code> is not equal to <code>"PEM"</code>.
If <code>method</code> equals <code>"PEM"</code>, the arguments are passed to
 <code><a href='PseudoEMAlgorithm.html'>PseudoEMAlgorithm</a></code> if the <code>method</code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of parameters formatted as described in <code><a href='rtheta.html'>rtheta</a></code>.</p>
<p>When <code>method</code> equals <code>"PEM"</code>, a list of extra information
(log-likelihood trace, the matrix of group probabilities, theta trace) is
added as an attribute called "extra".</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The <code>"L-BFGS-B"</code> method does not perform a transformation of
  the parameters and uses box constraints as implemented in <code>optim</code>. <br />
  Note that the many parameter configurations are poorly estimable or
  directly unidentifiable.</p>
<p><code>fit.general.GMCM</code> is simply an alias of <code>fit.full.gmcm</code>.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>All the optimization procedures are strongly dependent on the initial
  values and other parameters (such as the cooling scheme for method SANN).
  Therefore it is advisable to apply multiple
  different initial parameters (and optimization routines) and select the
  best fit.</p>
<p>The <code><a href='choose.theta.html'>choose.theta</a></code> itself chooses random a initialization.
  Hence, the output when <code>theta</code> is not directly supplied can vary.</p>
<p>See <code><a href='https://rdrr.io/r/stats/optim.html'>optim</a></code> for further details.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Li, Q., Brown, J. B. J. B., Huang, H., &amp; Bickel, P. J. (2011).
  Measuring reproducibility of high-throughput experiments. The Annals of
  Applied Statistics, 5(3), 1752-1779. doi:10.1214/11-AOAS466</p>
<p>Tewari, A., Giering, M. J., &amp; Raghunathan, A. (2011). Parametric
  Characterization of Multimodal Distributions with Non-gaussian Modes. 2011
  IEEE 11th International Conference on Data Mining Workshops, 286-292.
doi:10.1109/ICDMW.2011.135</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/r/stats/optim.html'>optim</a></code>, <code><a href='get.IDR.html'>get.prob</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>17</span>)
<span class='no'>sim</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='SimulateGMCMData.html'>SimulateGMCMData</a></span>(<span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>1000</span>, <span class='kw'>m</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>d</span> <span class='kw'>=</span> <span class='fl'>2</span>)

<span class='co'># Plotting simulated data</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>mfrow</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>))
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>sim</span>$<span class='no'>z</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/palettes.html'>rainbow</a></span>(<span class='fl'>3</span>)[<span class='no'>sim</span>$<span class='no'>K</span>], <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Latent process"</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>sim</span>$<span class='no'>u</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/palettes.html'>rainbow</a></span>(<span class='fl'>3</span>)[<span class='no'>sim</span>$<span class='no'>K</span>], <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"GMCM process"</span>)</div><div class='img'><img src='fit.full.GMCM-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Observed data</span>
<span class='no'>uhat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='Uhat.html'>Uhat</a></span>(<span class='no'>sim</span>$<span class='no'>u</span>)

<span class='co'># The model should be fitted multiple times using different starting estimates</span>
<span class='no'>start.theta</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='choose.theta.html'>choose.theta</a></span>(<span class='no'>uhat</span>, <span class='kw'>m</span> <span class='kw'>=</span> <span class='fl'>3</span>)  <span class='co'># Random starting estimate</span>
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'>fit.full.GMCM</span>(<span class='kw'>u</span> <span class='kw'>=</span> <span class='no'>uhat</span>, <span class='kw'>theta</span> <span class='kw'>=</span> <span class='no'>start.theta</span>,
                     <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"NM"</span>, <span class='kw'>max.ite</span> <span class='kw'>=</span> <span class='fl'>3000</span>,
                     <span class='kw'>reltol</span> <span class='kw'>=</span> <span class='fl'>1e-2</span>, <span class='kw'>trace</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)  <span class='co'># Note, 1e-2 is too big</span></div><div class='output co'>#&gt;   Nelder-Mead direct search function minimizer
#&gt; function value for initial parameters = -515.677431
#&gt;   Scaled convergence tolerance is 5.15687
#&gt; Stepsize computed as 0.663369
#&gt; BUILD             15 -233.466568 -569.353481
#&gt; LO-REDUCTION      17 -360.088579 -569.353481
#&gt; LO-REDUCTION      19 -391.504816 -569.353481
#&gt; LO-REDUCTION      21 -451.129739 -569.353481
#&gt; LO-REDUCTION      23 -461.047890 -569.353481
#&gt; LO-REDUCTION      25 -474.288678 -569.353481
#&gt; LO-REDUCTION      27 -475.439883 -569.353481
#&gt; LO-REDUCTION      29 -481.207214 -569.353481
#&gt; LO-REDUCTION      31 -489.943830 -569.353481
#&gt; LO-REDUCTION      33 -499.441727 -569.353481
#&gt; LO-REDUCTION      35 -507.057593 -569.353481
#&gt; REFLECTION        37 -515.677431 -579.710852
#&gt; LO-REDUCTION      39 -516.341220 -579.710852
#&gt; REFLECTION        41 -523.650851 -591.482170
#&gt; LO-REDUCTION      43 -525.001721 -591.482170
#&gt; LO-REDUCTION      45 -526.070773 -591.482170
#&gt; REFLECTION        47 -526.108722 -596.206356
#&gt; LO-REDUCTION      49 -540.212280 -596.206356
#&gt; REFLECTION        51 -542.068410 -604.599710
#&gt; REFLECTION        53 -555.609732 -609.062833
#&gt; LO-REDUCTION      55 -560.130562 -609.062833
#&gt; LO-REDUCTION      57 -561.023258 -609.062833
#&gt; REFLECTION        59 -561.589751 -615.381568
#&gt; LO-REDUCTION      61 -566.058019 -615.381568
#&gt; LO-REDUCTION      63 -569.353481 -615.381568
#&gt; LO-REDUCTION      65 -575.570364 -615.381568
#&gt; LO-REDUCTION      67 -576.231025 -615.381568
#&gt; REFLECTION        69 -577.343375 -625.519534
#&gt; LO-REDUCTION      71 -579.710852 -625.519534
#&gt; LO-REDUCTION      73 -586.982991 -625.519534
#&gt; LO-REDUCTION      75 -591.482170 -625.519534
#&gt; LO-REDUCTION      77 -596.206356 -625.519534
#&gt; LO-REDUCTION      79 -598.448986 -625.519534
#&gt; EXTENSION         81 -602.753543 -641.265243
#&gt; LO-REDUCTION      83 -604.599710 -641.265243
#&gt; LO-REDUCTION      85 -604.931952 -641.265243
#&gt; LO-REDUCTION      87 -605.577558 -641.265243
#&gt; LO-REDUCTION      89 -609.062833 -641.265243
#&gt; LO-REDUCTION      91 -612.091133 -641.265243
#&gt; HI-REDUCTION      93 -614.099998 -641.265243
#&gt; LO-REDUCTION      95 -614.627823 -641.265243
#&gt; LO-REDUCTION      97 -615.381568 -641.265243
#&gt; LO-REDUCTION      99 -618.027833 -641.265243
#&gt; LO-REDUCTION     101 -619.092044 -641.265243
#&gt; REFLECTION       103 -619.357749 -641.693442
#&gt; LO-REDUCTION     105 -622.441487 -641.693442
#&gt; LO-REDUCTION     107 -625.409598 -641.693442
#&gt; LO-REDUCTION     109 -625.519534 -641.693442
#&gt; REFLECTION       111 -629.884656 -644.530662
#&gt; LO-REDUCTION     113 -630.792755 -644.530662
#&gt; EXTENSION        115 -634.014884 -655.964948
#&gt; HI-REDUCTION     117 -635.322421 -655.964948
#&gt; LO-REDUCTION     119 -635.326358 -655.964948
#&gt; LO-REDUCTION     121 -635.807326 -655.964948
#&gt; LO-REDUCTION     123 -636.374048 -655.964948
#&gt; LO-REDUCTION     125 -637.325710 -655.964948
#&gt; LO-REDUCTION     127 -639.109719 -655.964948
#&gt; LO-REDUCTION     129 -639.617899 -655.964948
#&gt; EXTENSION        131 -640.493132 -659.440762
#&gt; LO-REDUCTION     133 -640.814311 -659.440762
#&gt; LO-REDUCTION     135 -640.966449 -659.440762
#&gt; EXTENSION        137 -641.265243 -667.821972
#&gt; LO-REDUCTION     139 -641.693442 -667.821972
#&gt; LO-REDUCTION     141 -642.952864 -667.821972
#&gt; LO-REDUCTION     143 -644.530662 -667.821972
#&gt; LO-REDUCTION     145 -647.153524 -667.821972
#&gt; LO-REDUCTION     147 -648.818000 -667.821972
#&gt; EXTENSION        149 -650.175526 -675.757168
#&gt; LO-REDUCTION     151 -653.343654 -675.757168
#&gt; LO-REDUCTION     153 -653.702803 -675.757168
#&gt; EXTENSION        155 -653.790597 -687.329146
#&gt; LO-REDUCTION     157 -654.261844 -687.329146
#&gt; LO-REDUCTION     159 -655.964948 -687.329146
#&gt; LO-REDUCTION     161 -657.428177 -687.329146
#&gt; LO-REDUCTION     163 -657.685808 -687.329146
#&gt; EXTENSION        165 -659.440762 -700.605260
#&gt; LO-REDUCTION     167 -660.131492 -700.605260
#&gt; LO-REDUCTION     169 -663.955661 -700.605260
#&gt; LO-REDUCTION     171 -664.319470 -700.605260
#&gt; LO-REDUCTION     173 -665.820825 -700.605260
#&gt; LO-REDUCTION     175 -667.821972 -700.605260
#&gt; LO-REDUCTION     177 -670.250488 -700.605260
#&gt; LO-REDUCTION     179 -673.289928 -700.605260
#&gt; LO-REDUCTION     181 -673.504919 -700.605260
#&gt; LO-REDUCTION     183 -675.236927 -700.605260
#&gt; LO-REDUCTION     185 -675.757168 -700.605260
#&gt; LO-REDUCTION     187 -677.011890 -700.605260
#&gt; LO-REDUCTION     189 -677.284970 -700.605260
#&gt; LO-REDUCTION     191 -680.672717 -700.605260
#&gt; LO-REDUCTION     193 -682.225729 -700.605260
#&gt; REFLECTION       195 -686.816260 -703.037378
#&gt; REFLECTION       197 -687.329146 -704.823249
#&gt; LO-REDUCTION     199 -696.161058 -704.823249
#&gt; LO-REDUCTION     201 -696.816536 -704.823249
#&gt; LO-REDUCTION     203 -697.051916 -704.823249
#&gt; LO-REDUCTION     205 -697.522200 -704.823249
#&gt; LO-REDUCTION     207 -697.563742 -704.823249
#&gt; LO-REDUCTION     209 -697.613372 -704.823249
#&gt; LO-REDUCTION     211 -697.636404 -704.823249
#&gt; LO-REDUCTION     213 -698.357256 -704.823249
#&gt; EXTENSION        215 -699.248054 -709.202590
#&gt; LO-REDUCTION     217 -699.569908 -709.202590
#&gt; LO-REDUCTION     219 -699.812683 -709.202590
#&gt; LO-REDUCTION     221 -700.605260 -709.202590
#&gt; LO-REDUCTION     223 -701.380495 -709.202590
#&gt; LO-REDUCTION     225 -701.503982 -709.202590
#&gt; LO-REDUCTION     227 -701.841279 -709.202590
#&gt; LO-REDUCTION     229 -702.506988 -709.202590
#&gt; LO-REDUCTION     231 -702.580614 -709.202590
#&gt; LO-REDUCTION     233 -702.638558 -709.202590
#&gt; LO-REDUCTION     235 -702.707891 -709.202590
#&gt; LO-REDUCTION     237 -703.037378 -709.202590
#&gt; LO-REDUCTION     239 -703.438232 -709.202590
#&gt; EXTENSION        241 -703.861786 -712.515868
#&gt; LO-REDUCTION     243 -704.005156 -712.515868
#&gt; EXTENSION        245 -704.231055 -715.399180
#&gt; LO-REDUCTION     247 -704.823249 -715.399180
#&gt; LO-REDUCTION     249 -704.861669 -715.399180
#&gt; LO-REDUCTION     251 -706.649655 -715.399180
#&gt; LO-REDUCTION     253 -706.868694 -715.399180
#&gt; LO-REDUCTION     255 -707.684672 -715.399180
#&gt; EXTENSION        257 -707.695228 -717.962338
#&gt; LO-REDUCTION     259 -707.889608 -717.962338
#&gt; EXTENSION        261 -708.512464 -720.918137
#&gt; LO-REDUCTION     263 -708.531180 -720.918137
#&gt; LO-REDUCTION     265 -709.032097 -720.918137
#&gt; LO-REDUCTION     267 -709.202590 -720.918137
#&gt; LO-REDUCTION     269 -710.313966 -720.918137
#&gt; EXTENSION        271 -711.333368 -722.178713
#&gt; EXTENSION        273 -712.515868 -724.753334
#&gt; LO-REDUCTION     275 -713.683303 -724.753334
#&gt; LO-REDUCTION     277 -714.268189 -724.753334
#&gt; LO-REDUCTION     279 -714.964345 -724.753334
#&gt; LO-REDUCTION     281 -715.104848 -724.753334
#&gt; LO-REDUCTION     283 -715.399180 -724.753334
#&gt; REFLECTION       285 -715.641759 -725.277362
#&gt; LO-REDUCTION     287 -716.878778 -725.277362
#&gt; REFLECTION       289 -717.962338 -726.211348
#&gt; REFLECTION       291 -717.991683 -726.947814
#&gt; LO-REDUCTION     293 -718.696937 -726.947814
#&gt; LO-REDUCTION     295 -719.193252 -726.947814
#&gt; LO-REDUCTION     297 -720.918137 -726.947814
#&gt; Exiting from Nelder Mead minimizer
#&gt;     299 function evaluations used</div><div class='input'>
<span class='co'># Confusion matrix</span>
<span class='no'>Khat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span>(<span class='fu'><a href='get.IDR.html'>get.prob</a></span>(<span class='no'>uhat</span>, <span class='kw'>theta</span> <span class='kw'>=</span> <span class='no'>res</span>), <span class='fl'>1</span>, <span class='no'>which.max</span>)
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span>(<span class='st'>"Khat"</span> <span class='kw'>=</span> <span class='no'>Khat</span>, <span class='st'>"K"</span> <span class='kw'>=</span> <span class='no'>sim</span>$<span class='no'>K</span>)  <span class='co'># Note, some components have been swapped</span></div><div class='output co'>#&gt;     K
#&gt; Khat   1   2   3
#&gt;    1   0 581   0
#&gt;    2   0   0 293
#&gt;    3  97  29   0</div><div class='input'>
<span class='co'># Simulation from GMCM with the fitted parameters</span>
<span class='no'>simfit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='SimulateGMCMData.html'>SimulateGMCMData</a></span>(<span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>1000</span>, <span class='kw'>theta</span> <span class='kw'>=</span> <span class='no'>res</span>)

<span class='co'># As seen, the underlying latent process is hard to estimate.</span>
<span class='co'># The clustering, however, is very good.</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>mfrow</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>,<span class='fl'>2</span>))
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>simfit</span>$<span class='no'>z</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='no'>simfit</span>$<span class='no'>K</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Model check 1\nSimulated GMM"</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>simfit</span>$<span class='no'>u</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='no'>simfit</span>$<span class='no'>K</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Model check 2\nSimulated GMCM"</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>sim</span>$<span class='no'>u</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='no'>Khat</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"MAP clustering"</span>)</div><div class='img'><img src='fit.full.GMCM-2.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Anders Ellern Bilgrau &lt;anders.ellern.bilgrau@gmail.com&gt;</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Anders Ellern Bilgrau.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9100.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


