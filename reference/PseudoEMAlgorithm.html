<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>EM-like algorithm for the GMCM — PseudoEMAlgorithm • GMCM</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="EM-like algorithm for the GMCM — PseudoEMAlgorithm" />
<meta property="og:description" content="An fast and modified implementation of the Li et. al. (2011) EM-like
algorithm for estimating the maximizing parameters of the GMCM-likelihood
function." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-155943904-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-155943904-1');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GMCM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.4.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/AEBilgrau/GMCM/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>EM-like algorithm for the GMCM</h1>
    <small class="dont-index">Source: <a href='https://github.com/AEBilgrau/GMCM/blob/master/R/PseudoEMAlgorithm.R'><code>R/PseudoEMAlgorithm.R</code></a></small>
    <div class="hidden name"><code>PseudoEMAlgorithm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>An fast and modified implementation of the Li et. al. (2011) EM-like
algorithm for estimating the maximizing parameters of the GMCM-likelihood
function.</p>
    </div>

    <pre class="usage"><span class='fu'>PseudoEMAlgorithm</span>(<span class='kw'>x</span>, <span class='kw'>theta</span>, eps = <span class='fl'>1e-04</span>, max.ite = <span class='fl'>1000</span>,
  verbose = <span class='fl'>FALSE</span>, trace.theta = <span class='fl'>FALSE</span>, meta.special.case = <span class='fl'>FALSE</span>,
  convergence.criterion = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"absGMCM"</span>, <span class='st'>"GMCM"</span>, <span class='st'>"GMM"</span>, <span class='st'>"Li"</span>, <span class='st'>"absLi"</span>))</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A matrix of observations where rows corresponds to features and
columns to experiments.</p></td>
    </tr>
    <tr>
      <th>theta</th>
      <td><p>A list of parameters formatted as described in
<code><a href='rtheta.html'>rtheta</a></code>.</p></td>
    </tr>
    <tr>
      <th>eps</th>
      <td><p>The maximum difference required to achieve convergence.</p></td>
    </tr>
    <tr>
      <th>max.ite</th>
      <td><p>The maximum number of iterations.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Logical. Set to <code>TRUE</code> to increase verbosity.</p></td>
    </tr>
    <tr>
      <th>trace.theta</th>
      <td><p>Logical. If <code>TRUE</code>, a trace of the estimated thetas
are returned.</p></td>
    </tr>
    <tr>
      <th>meta.special.case</th>
      <td><p>Logical. If <code>TRUE</code>, the estimators used are for
the special case GMCM of Li et. al. (2011).</p></td>
    </tr>
    <tr>
      <th>convergence.criterion</th>
      <td><p>Character. Sets the convergence criterion.  If
<code>"absGMCM"</code> the absolute value of difference in GMCM is used. If
<code>"GMCM"</code> the difference in GMCM-likelihoods are used as convergence
criterion. If <code>"GMM"</code>, the guaranteed non-decreasing difference of
GMM-likelihoods are used. If <code>"Li"</code>, the convergence criterion used by
Li et. al. (2011) is used. If <code>"absLi"</code>, the absolute values of the Li
et. al. criterion.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of 3 or 4 is returned depending on the value of
<code>trace.theta</code></p>
<dt>theta</dt><dd><p>A list containing the final parameter
estimate in the format of <code><a href='rtheta.html'>rtheta</a></code></p></dd> <dt>loglik.tr</dt><dd><p>A matrix
with different log-likelihood traces in each row.</p></dd> <dt>kappa</dt><dd><p>A matrix
where the (i,j)'th entry is the probability that <code>x[i, ]</code> belongs to
the j'th component. Usually the returned value of <code>EStep</code>.</p></dd>
<dt>theta.tr</dt><dd><p>A list of each obtained parameter estimates in the format of
<code><a href='rtheta.html'>rtheta</a></code></p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>When either <code>"absGMCM"</code> or <code>"absLi"</code> are used, the parameters
corresponding to the biggest observed likelihood is returned. This is not
necessarily the last iteration.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The algorithm is highly sensitive to the starting parameters which
therefore should be carefully chosen.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Li, Q., Brown, J. B. J. B., Huang, H., &amp; Bickel, P. J. (2011).
  Measuring reproducibility of high-throughput experiments. The Annals of
  Applied Statistics, 5(3), 1752-1779. doi:10.1214/11-AOAS466</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='rtheta.html'>rtheta</a></code>, <code><a href='EMAlgorithm.html'>EMAlgorithm</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Anders Ellern Bilgrau &lt;anders.ellern.bilgrau@gmail.com&gt;</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>1</span>)

<span class='co'># Choosing the true parameters and simulating data</span>
<span class='kw'>true.par</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.8</span>, <span class='fl'>3</span>, <span class='fl'>1.5</span>, <span class='fl'>0.4</span>)
<span class='kw'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='SimulateGMCMData.html'>SimulateGMCMData</a></span>(n = <span class='fl'>1000</span>, par = <span class='kw'>true.par</span>, d = <span class='fl'>2</span>)
<span class='kw'>uhat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='Uhat.html'>Uhat</a></span>(<span class='kw'>data</span><span class='op'>$</span><span class='kw'>u</span>)  <span class='co'># Observed ranks</span>

<span class='co'># Plot of latent and observed data colour coded by the true component</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(mfrow = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>))
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span>(<span class='kw'>data</span><span class='op'>$</span><span class='kw'>z</span>, main = <span class='st'>"Latent data"</span>, cex = <span class='fl'>0.6</span>,
     xlab = <span class='st'>"z (Experiment 1)"</span>, ylab = <span class='st'>"z (Experiment 2)"</span>,
     col = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"red"</span>,<span class='st'>"blue"</span>)[<span class='kw'>data</span><span class='op'>$</span><span class='kw'>K</span>])
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span>(<span class='kw'>uhat</span>, main = <span class='st'>"Observed data"</span>, cex = <span class='fl'>0.6</span>,
     xlab = <span class='st'>"u (Experiment 1)"</span>, ylab = <span class='st'>"u (Experiment 2)"</span>,
     col = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"red"</span>,<span class='st'>"blue"</span>)[<span class='kw'>data</span><span class='op'>$</span><span class='kw'>K</span>])
</div><div class='img'><img src='PseudoEMAlgorithm-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Fit the model using the Pseudo EM algorithm</span>
<span class='kw'>init.par</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.5</span>, <span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>0.5</span>)
<span class='kw'>res</span> <span class='op'>&lt;-</span> <span class='kw'>GMCM</span>:::<span class='fu'>PseudoEMAlgorithm</span>(<span class='kw'>uhat</span>, <span class='fu'><a href='full2meta.html'>meta2full</a></span>(<span class='kw'>init.par</span>, d = <span class='fl'>2</span>),
                                verbose = <span class='fl'>TRUE</span>,
                                convergence.criterion = <span class='st'>"absGMCM"</span>,
                                eps = <span class='fl'>1e-4</span>,
                                trace.theta = <span class='fl'>FALSE</span>,
                                meta.special.case = <span class='fl'>TRUE</span>)
</div><div class='output co'>#&gt; 2 | delta = 17.868577 | gmm = -2885.75 | gmcm =  167.34 
#&gt; 3 | delta = 8.082063 | gmm = -2907.74 | gmcm =  175.42 
#&gt; 4 | delta = 6.050655 | gmm = -2927.31 | gmcm =  181.47 
#&gt; 5 | delta = 5.348391 | gmm = -2945.36 | gmcm =  186.82 
#&gt; 6 | delta = 4.839607 | gmm = -2962.35 | gmcm =  191.66 
#&gt; 7 | delta = 4.347890 | gmm = -2978.45 | gmcm =  196.00 
#&gt; 8 | delta = 3.874041 | gmm = -2993.69 | gmcm =  199.88 
#&gt; 9 | delta = 3.435810 | gmm = -3008.08 | gmcm =  203.31 
#&gt; 10 | delta = 3.052414 | gmm = -3021.64 | gmcm =  206.37 
#&gt; 11 | delta = 2.721477 | gmm = -3034.39 | gmcm =  209.09 
#&gt; 12 | delta = 2.443531 | gmm = -3046.37 | gmcm =  211.53 
#&gt; 13 | delta = 2.211751 | gmm = -3057.62 | gmcm =  213.74 
#&gt; 14 | delta = 2.015994 | gmm = -3068.18 | gmcm =  215.76 
#&gt; 15 | delta = 1.853092 | gmm = -3078.07 | gmcm =  217.61 
#&gt; 16 | delta = 1.715827 | gmm = -3087.35 | gmcm =  219.33 
#&gt; 17 | delta = 1.599870 | gmm = -3096.02 | gmcm =  220.93 
#&gt; 18 | delta = 1.500794 | gmm = -3104.13 | gmcm =  222.43 
#&gt; 19 | delta = 1.416708 | gmm = -3111.69 | gmcm =  223.85 
#&gt; 20 | delta = 1.344361 | gmm = -3118.72 | gmcm =  225.19 
#&gt; 21 | delta = 1.282530 | gmm = -3125.24 | gmcm =  226.47 
#&gt; 22 | delta = 1.228756 | gmm = -3131.26 | gmcm =  227.70 
#&gt; 23 | delta = 1.181350 | gmm = -3136.79 | gmcm =  228.88 
#&gt; 24 | delta = 1.139250 | gmm = -3141.84 | gmcm =  230.02 
#&gt; 25 | delta = 1.100991 | gmm = -3146.39 | gmcm =  231.12 
#&gt; 26 | delta = 1.063712 | gmm = -3150.46 | gmcm =  232.19 
#&gt; 27 | delta = 1.026408 | gmm = -3154.02 | gmcm =  233.21 
#&gt; 28 | delta = 0.987403 | gmm = -3157.07 | gmcm =  234.20 
#&gt; 29 | delta = 0.942761 | gmm = -3159.60 | gmcm =  235.14 
#&gt; 30 | delta = 0.891736 | gmm = -3161.58 | gmcm =  236.04 
#&gt; 31 | delta = 0.831993 | gmm = -3163.02 | gmcm =  236.87 
#&gt; 32 | delta = 0.761030 | gmm = -3163.90 | gmcm =  237.63 
#&gt; 33 | delta = 0.680361 | gmm = -3164.23 | gmcm =  238.31 
#&gt; 34 | delta = 0.590134 | gmm = -3164.02 | gmcm =  238.90 
#&gt; 35 | delta = 0.493854 | gmm = -3163.32 | gmcm =  239.39 
#&gt; 36 | delta = 0.395795 | gmm = -3162.17 | gmcm =  239.79 
#&gt; 37 | delta = 0.301642 | gmm = -3160.62 | gmcm =  240.09 
#&gt; 38 | delta = 0.215391 | gmm = -3158.76 | gmcm =  240.31 
#&gt; 39 | delta = 0.141003 | gmm = -3156.64 | gmcm =  240.45 
#&gt; 40 | delta = 0.079594 | gmm = -3154.35 | gmcm =  240.53 
#&gt; 41 | delta = 0.031830 | gmm = -3151.94 | gmcm =  240.56 
#&gt; 42 | delta = 0.004377 | gmm = -3149.48 | gmcm =  240.55 
#&gt; 43 | delta = 0.030996 | gmm = -3147.00 | gmcm =  240.52 
#&gt; 44 | delta = 0.048803 | gmm = -3144.55 | gmcm =  240.47 
#&gt; 45 | delta = 0.061279 | gmm = -3142.14 | gmcm =  240.41 
#&gt; 46 | delta = 0.069590 | gmm = -3139.79 | gmcm =  240.34 
#&gt; 47 | delta = 0.074513 | gmm = -3137.50 | gmcm =  240.27 
#&gt; 48 | delta = 0.077553 | gmm = -3135.30 | gmcm =  240.19 
#&gt; 49 | delta = 0.079276 | gmm = -3133.16 | gmcm =  240.11 
#&gt; 50 | delta = 0.080348 | gmm = -3131.10 | gmcm =  240.03 
#&gt; 51 | delta = 0.080030 | gmm = -3129.12 | gmcm =  239.95 
#&gt; 52 | delta = 0.079876 | gmm = -3127.20 | gmcm =  239.87 
#&gt; 53 | delta = 0.079019 | gmm = -3125.35 | gmcm =  239.79 
#&gt; 54 | delta = 0.078102 | gmm = -3123.57 | gmcm =  239.71 
#&gt; 55 | delta = 0.077079 | gmm = -3121.84 | gmcm =  239.64 
#&gt; 56 | delta = 0.075983 | gmm = -3120.18 | gmcm =  239.56 
#&gt; 57 | delta = 0.074535 | gmm = -3118.57 | gmcm =  239.49 
#&gt; 58 | delta = 0.072803 | gmm = -3117.02 | gmcm =  239.41 
#&gt; 59 | delta = 0.071558 | gmm = -3115.52 | gmcm =  239.34 
#&gt; 60 | delta = 0.069940 | gmm = -3114.07 | gmcm =  239.27 
#&gt; 61 | delta = 0.068348 | gmm = -3112.66 | gmcm =  239.20 
#&gt; 62 | delta = 0.066729 | gmm = -3111.31 | gmcm =  239.14 
#&gt; 63 | delta = 0.065271 | gmm = -3110.00 | gmcm =  239.07 
#&gt; 64 | delta = 0.063689 | gmm = -3108.74 | gmcm =  239.01 
#&gt; 65 | delta = 0.061805 | gmm = -3107.52 | gmcm =  238.95 
#&gt; 66 | delta = 0.060516 | gmm = -3106.34 | gmcm =  238.89 
#&gt; 67 | delta = 0.058488 | gmm = -3105.20 | gmcm =  238.83 
#&gt; 68 | delta = 0.057113 | gmm = -3104.10 | gmcm =  238.77 
#&gt; 69 | delta = 0.055391 | gmm = -3103.04 | gmcm =  238.72 
#&gt; 70 | delta = 0.053966 | gmm = -3102.01 | gmcm =  238.66 
#&gt; 71 | delta = 0.052288 | gmm = -3101.02 | gmcm =  238.61 
#&gt; 72 | delta = 0.050634 | gmm = -3100.07 | gmcm =  238.56 
#&gt; 73 | delta = 0.049541 | gmm = -3099.15 | gmcm =  238.51 
#&gt; 74 | delta = 0.047722 | gmm = -3098.26 | gmcm =  238.46 
#&gt; 75 | delta = 0.046379 | gmm = -3097.40 | gmcm =  238.41 
#&gt; 76 | delta = 0.044991 | gmm = -3096.57 | gmcm =  238.37 
#&gt; 77 | delta = 0.043599 | gmm = -3095.78 | gmcm =  238.33 
#&gt; 78 | delta = 0.042113 | gmm = -3095.01 | gmcm =  238.28 
#&gt; 79 | delta = 0.040781 | gmm = -3094.27 | gmcm =  238.24 
#&gt; 80 | delta = 0.039585 | gmm = -3093.55 | gmcm =  238.20 
#&gt; 81 | delta = 0.038263 | gmm = -3092.87 | gmcm =  238.17 
#&gt; 82 | delta = 0.037011 | gmm = -3092.20 | gmcm =  238.13 
#&gt; 83 | delta = 0.035897 | gmm = -3091.56 | gmcm =  238.09 
#&gt; 84 | delta = 0.034441 | gmm = -3090.95 | gmcm =  238.06 
#&gt; 85 | delta = 0.033345 | gmm = -3090.36 | gmcm =  238.02 
#&gt; 86 | delta = 0.032295 | gmm = -3089.78 | gmcm =  237.99 
#&gt; 87 | delta = 0.031258 | gmm = -3089.23 | gmcm =  237.96 
#&gt; 88 | delta = 0.030116 | gmm = -3088.71 | gmcm =  237.93 
#&gt; 89 | delta = 0.029077 | gmm = -3088.20 | gmcm =  237.90 
#&gt; 90 | delta = 0.028054 | gmm = -3087.70 | gmcm =  237.87 
#&gt; 91 | delta = 0.027176 | gmm = -3087.23 | gmcm =  237.85 
#&gt; 92 | delta = 0.026403 | gmm = -3086.78 | gmcm =  237.82 
#&gt; 93 | delta = 0.025197 | gmm = -3086.34 | gmcm =  237.80 
#&gt; 94 | delta = 0.024321 | gmm = -3085.92 | gmcm =  237.77 
#&gt; 95 | delta = 0.023404 | gmm = -3085.51 | gmcm =  237.75 
#&gt; 96 | delta = 0.022557 | gmm = -3085.12 | gmcm =  237.72 
#&gt; 97 | delta = 0.021739 | gmm = -3084.75 | gmcm =  237.70 
#&gt; 98 | delta = 0.021174 | gmm = -3084.38 | gmcm =  237.68 
#&gt; 99 | delta = 0.020324 | gmm = -3084.04 | gmcm =  237.66 
#&gt; 100 | delta = 0.019571 | gmm = -3083.70 | gmcm =  237.64 
#&gt; 101 | delta = 0.018864 | gmm = -3083.38 | gmcm =  237.62 
#&gt; 102 | delta = 0.018122 | gmm = -3083.07 | gmcm =  237.60 
#&gt; 103 | delta = 0.017433 | gmm = -3082.78 | gmcm =  237.59 
#&gt; 104 | delta = 0.016851 | gmm = -3082.49 | gmcm =  237.57 
#&gt; 105 | delta = 0.016232 | gmm = -3082.21 | gmcm =  237.55 
#&gt; 106 | delta = 0.015583 | gmm = -3081.95 | gmcm =  237.54 
#&gt; 107 | delta = 0.014975 | gmm = -3081.69 | gmcm =  237.52 
#&gt; 108 | delta = 0.014420 | gmm = -3081.45 | gmcm =  237.51 
#&gt; 109 | delta = 0.013892 | gmm = -3081.22 | gmcm =  237.50 
#&gt; 110 | delta = 0.013395 | gmm = -3080.99 | gmcm =  237.48 
#&gt; 111 | delta = 0.012932 | gmm = -3080.77 | gmcm =  237.47 
#&gt; 112 | delta = 0.012513 | gmm = -3080.56 | gmcm =  237.46 
#&gt; 113 | delta = 0.012074 | gmm = -3080.36 | gmcm =  237.44 
#&gt; 114 | delta = 0.011569 | gmm = -3080.17 | gmcm =  237.43 
#&gt; 115 | delta = 0.011113 | gmm = -3079.98 | gmcm =  237.42 
#&gt; 116 | delta = 0.010670 | gmm = -3079.80 | gmcm =  237.41 
#&gt; 117 | delta = 0.010217 | gmm = -3079.63 | gmcm =  237.40 
#&gt; 118 | delta = 0.009841 | gmm = -3079.47 | gmcm =  237.39 
#&gt; 119 | delta = 0.009477 | gmm = -3079.31 | gmcm =  237.38 
#&gt; 120 | delta = 0.009106 | gmm = -3079.16 | gmcm =  237.37 
#&gt; 121 | delta = 0.008760 | gmm = -3079.01 | gmcm =  237.36 
#&gt; 122 | delta = 0.008448 | gmm = -3078.87 | gmcm =  237.36 
#&gt; 123 | delta = 0.008137 | gmm = -3078.73 | gmcm =  237.35 
#&gt; 124 | delta = 0.007861 | gmm = -3078.60 | gmcm =  237.34 
#&gt; 125 | delta = 0.007550 | gmm = -3078.48 | gmcm =  237.33 
#&gt; 126 | delta = 0.007260 | gmm = -3078.36 | gmcm =  237.32 
#&gt; 127 | delta = 0.007005 | gmm = -3078.24 | gmcm =  237.32 
#&gt; 128 | delta = 0.006747 | gmm = -3078.13 | gmcm =  237.31 
#&gt; 129 | delta = 0.006459 | gmm = -3078.03 | gmcm =  237.30 
#&gt; 130 | delta = 0.006158 | gmm = -3077.92 | gmcm =  237.30 
#&gt; 131 | delta = 0.005900 | gmm = -3077.83 | gmcm =  237.29 
#&gt; 132 | delta = 0.005662 | gmm = -3077.73 | gmcm =  237.29 
#&gt; 133 | delta = 0.005437 | gmm = -3077.64 | gmcm =  237.28 
#&gt; 134 | delta = 0.005224 | gmm = -3077.55 | gmcm =  237.28 
#&gt; 135 | delta = 0.005026 | gmm = -3077.47 | gmcm =  237.27 
#&gt; 136 | delta = 0.004835 | gmm = -3077.39 | gmcm =  237.27 
#&gt; 137 | delta = 0.004638 | gmm = -3077.31 | gmcm =  237.26 
#&gt; 138 | delta = 0.004463 | gmm = -3077.24 | gmcm =  237.26 
#&gt; 139 | delta = 0.004294 | gmm = -3077.17 | gmcm =  237.25 
#&gt; 140 | delta = 0.004129 | gmm = -3077.10 | gmcm =  237.25 
#&gt; 141 | delta = 0.003973 | gmm = -3077.03 | gmcm =  237.24 
#&gt; 142 | delta = 0.003827 | gmm = -3076.97 | gmcm =  237.24 
#&gt; 143 | delta = 0.003688 | gmm = -3076.91 | gmcm =  237.24 
#&gt; 144 | delta = 0.003561 | gmm = -3076.85 | gmcm =  237.23 
#&gt; 145 | delta = 0.003434 | gmm = -3076.79 | gmcm =  237.23 
#&gt; 146 | delta = 0.003304 | gmm = -3076.74 | gmcm =  237.23 
#&gt; 147 | delta = 0.003184 | gmm = -3076.69 | gmcm =  237.22 
#&gt; 148 | delta = 0.003074 | gmm = -3076.64 | gmcm =  237.22 
#&gt; 149 | delta = 0.002949 | gmm = -3076.59 | gmcm =  237.22 
#&gt; 150 | delta = 0.002832 | gmm = -3076.54 | gmcm =  237.21 
#&gt; 151 | delta = 0.002717 | gmm = -3076.50 | gmcm =  237.21 
#&gt; 152 | delta = 0.002608 | gmm = -3076.46 | gmcm =  237.21 
#&gt; 153 | delta = 0.002507 | gmm = -3076.41 | gmcm =  237.21 
#&gt; 154 | delta = 0.002412 | gmm = -3076.38 | gmcm =  237.20 
#&gt; 155 | delta = 0.002342 | gmm = -3076.34 | gmcm =  237.20 
#&gt; 156 | delta = 0.002207 | gmm = -3076.30 | gmcm =  237.20 
#&gt; 157 | delta = 0.002119 | gmm = -3076.27 | gmcm =  237.20 
#&gt; 158 | delta = 0.002034 | gmm = -3076.23 | gmcm =  237.20 
#&gt; 159 | delta = 0.001951 | gmm = -3076.20 | gmcm =  237.19 
#&gt; 160 | delta = 0.001873 | gmm = -3076.17 | gmcm =  237.19 
#&gt; 161 | delta = 0.001798 | gmm = -3076.14 | gmcm =  237.19 
#&gt; 162 | delta = 0.001727 | gmm = -3076.11 | gmcm =  237.19 
#&gt; 163 | delta = 0.001658 | gmm = -3076.08 | gmcm =  237.19 
#&gt; 164 | delta = 0.001592 | gmm = -3076.06 | gmcm =  237.19 
#&gt; 165 | delta = 0.001529 | gmm = -3076.03 | gmcm =  237.18 
#&gt; 166 | delta = 0.001467 | gmm = -3076.01 | gmcm =  237.18 
#&gt; 167 | delta = 0.001409 | gmm = -3075.99 | gmcm =  237.18 
#&gt; 168 | delta = 0.001353 | gmm = -3075.96 | gmcm =  237.18 
#&gt; 169 | delta = 0.001299 | gmm = -3075.94 | gmcm =  237.18 
#&gt; 170 | delta = 0.001248 | gmm = -3075.92 | gmcm =  237.18 
#&gt; 171 | delta = 0.001199 | gmm = -3075.90 | gmcm =  237.18 
#&gt; 172 | delta = 0.001152 | gmm = -3075.88 | gmcm =  237.17 
#&gt; 173 | delta = 0.001107 | gmm = -3075.86 | gmcm =  237.17 
#&gt; 174 | delta = 0.001063 | gmm = -3075.85 | gmcm =  237.17 
#&gt; 175 | delta = 0.001021 | gmm = -3075.83 | gmcm =  237.17 
#&gt; 176 | delta = 0.000980 | gmm = -3075.81 | gmcm =  237.17 
#&gt; 177 | delta = 0.000942 | gmm = -3075.80 | gmcm =  237.17 
#&gt; 178 | delta = 0.000904 | gmm = -3075.78 | gmcm =  237.17 
#&gt; 179 | delta = 0.000869 | gmm = -3075.77 | gmcm =  237.17 
#&gt; 180 | delta = 0.000834 | gmm = -3075.76 | gmcm =  237.17 
#&gt; 181 | delta = 0.000802 | gmm = -3075.74 | gmcm =  237.17 
#&gt; 182 | delta = 0.000771 | gmm = -3075.73 | gmcm =  237.17 
#&gt; 183 | delta = 0.000741 | gmm = -3075.72 | gmcm =  237.16 
#&gt; 184 | delta = 0.000712 | gmm = -3075.71 | gmcm =  237.16 
#&gt; 185 | delta = 0.000684 | gmm = -3075.70 | gmcm =  237.16 
#&gt; 186 | delta = 0.000657 | gmm = -3075.68 | gmcm =  237.16 
#&gt; 187 | delta = 0.000633 | gmm = -3075.67 | gmcm =  237.16 
#&gt; 188 | delta = 0.000608 | gmm = -3075.66 | gmcm =  237.16 
#&gt; 189 | delta = 0.000585 | gmm = -3075.65 | gmcm =  237.16 
#&gt; 190 | delta = 0.000562 | gmm = -3075.65 | gmcm =  237.16 
#&gt; 191 | delta = 0.000540 | gmm = -3075.64 | gmcm =  237.16 
#&gt; 192 | delta = 0.000520 | gmm = -3075.63 | gmcm =  237.16 
#&gt; 193 | delta = 0.000499 | gmm = -3075.62 | gmcm =  237.16 
#&gt; 194 | delta = 0.000480 | gmm = -3075.61 | gmcm =  237.16 
#&gt; 195 | delta = 0.000462 | gmm = -3075.60 | gmcm =  237.16 
#&gt; 196 | delta = 0.000444 | gmm = -3075.60 | gmcm =  237.16 
#&gt; 197 | delta = 0.000427 | gmm = -3075.59 | gmcm =  237.16 
#&gt; 198 | delta = 0.000411 | gmm = -3075.58 | gmcm =  237.16 
#&gt; 199 | delta = 0.000395 | gmm = -3075.58 | gmcm =  237.16 
#&gt; 200 | delta = 0.000380 | gmm = -3075.57 | gmcm =  237.16 
#&gt; 201 | delta = 0.000365 | gmm = -3075.57 | gmcm =  237.16 
#&gt; 202 | delta = 0.000351 | gmm = -3075.56 | gmcm =  237.15 
#&gt; 203 | delta = 0.000337 | gmm = -3075.55 | gmcm =  237.15 
#&gt; 204 | delta = 0.000324 | gmm = -3075.55 | gmcm =  237.15 
#&gt; 205 | delta = 0.000312 | gmm = -3075.54 | gmcm =  237.15 
#&gt; 206 | delta = 0.000300 | gmm = -3075.54 | gmcm =  237.15 
#&gt; 207 | delta = 0.000288 | gmm = -3075.53 | gmcm =  237.15 
#&gt; 208 | delta = 0.000277 | gmm = -3075.53 | gmcm =  237.15 
#&gt; 209 | delta = 0.000266 | gmm = -3075.53 | gmcm =  237.15 
#&gt; 210 | delta = 0.000256 | gmm = -3075.52 | gmcm =  237.15 
#&gt; 211 | delta = 0.000246 | gmm = -3075.52 | gmcm =  237.15 
#&gt; 212 | delta = 0.000236 | gmm = -3075.51 | gmcm =  237.15 
#&gt; 213 | delta = 0.000227 | gmm = -3075.51 | gmcm =  237.15 
#&gt; 214 | delta = 0.000218 | gmm = -3075.51 | gmcm =  237.15 
#&gt; 215 | delta = 0.000210 | gmm = -3075.50 | gmcm =  237.15 
#&gt; 216 | delta = 0.000202 | gmm = -3075.50 | gmcm =  237.15 
#&gt; 217 | delta = 0.000194 | gmm = -3075.50 | gmcm =  237.15 
#&gt; 218 | delta = 0.000186 | gmm = -3075.49 | gmcm =  237.15 
#&gt; 219 | delta = 0.000179 | gmm = -3075.49 | gmcm =  237.15 
#&gt; 220 | delta = 0.000172 | gmm = -3075.49 | gmcm =  237.15 
#&gt; 221 | delta = 0.000165 | gmm = -3075.48 | gmcm =  237.15 
#&gt; 222 | delta = 0.000159 | gmm = -3075.48 | gmcm =  237.15 
#&gt; 223 | delta = 0.000153 | gmm = -3075.48 | gmcm =  237.15 
#&gt; 224 | delta = 0.000147 | gmm = -3075.48 | gmcm =  237.15 
#&gt; 225 | delta = 0.000141 | gmm = -3075.48 | gmcm =  237.15 
#&gt; 226 | delta = 0.000135 | gmm = -3075.47 | gmcm =  237.15 
#&gt; 227 | delta = 0.000130 | gmm = -3075.47 | gmcm =  237.15 
#&gt; 228 | delta = 0.000125 | gmm = -3075.47 | gmcm =  237.15 
#&gt; 229 | delta = 0.000120 | gmm = -3075.47 | gmcm =  237.15 
#&gt; 230 | delta = 0.000116 | gmm = -3075.46 | gmcm =  237.15 
#&gt; 231 | delta = 0.000111 | gmm = -3075.46 | gmcm =  237.15 
#&gt; 232 | delta = 0.000107 | gmm = -3075.46 | gmcm =  237.15 
#&gt; 233 | delta = 0.000103 | gmm = -3075.46 | gmcm =  237.15 
#&gt; 234 | delta = 0.000099 | gmm = -3075.46 | gmcm =  237.15 </div><div class='input'>
<span class='co'># Compute posterior cluster probabilities</span>
<span class='kw'>IDRs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='get.IDR.html'>get.IDR</a></span>(<span class='kw'>uhat</span>, par = <span class='fu'><a href='full2meta.html'>full2meta</a></span>(<span class='kw'>res</span><span class='op'>$</span><span class='kw'>theta</span>))

<span class='co'># Plot of observed data colour coded by the MAP estimate</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span>(<span class='kw'>res</span><span class='op'>$</span><span class='kw'>loglik</span>[<span class='fl'>3</span>,], main = <span class='st'>"Loglikelihood trace"</span>, type = <span class='st'>"l"</span>,
     ylab = <span class='st'>"log GMCM likelihood"</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span>(v = <span class='fu'><a href='https://rdrr.io/r/base/which.min.html'>which.max</a></span>(<span class='kw'>res</span><span class='op'>$</span><span class='kw'>loglik</span>[<span class='fl'>3</span>,])) <span class='co'># Chosen MLE</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span>(<span class='kw'>uhat</span>, main = <span class='st'>"Clustering\nIDR &lt; 0.05"</span>, xlab = <span class='st'>""</span>, ylab = <span class='st'>""</span>, cex = <span class='fl'>0.6</span>,
     col = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"Red"</span>,<span class='st'>"Blue"</span>)[<span class='kw'>IDRs</span><span class='op'>$</span><span class='kw'>Khat</span>])
</div><div class='img'><img src='PseudoEMAlgorithm-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># View parameters</span>
<span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span>(<span class='kw'>init.par</span>, <span class='kw'>true.par</span>, estimate = <span class='fu'><a href='full2meta.html'>full2meta</a></span>(<span class='kw'>res</span><span class='op'>$</span><span class='kw'>theta</span>))
</div><div class='output co'>#&gt;               pie1    mu.mu     sigma       rho
#&gt; init.par 0.5000000 1.000000 1.0000000 0.5000000
#&gt; true.par 0.8000000 3.000000 1.5000000 0.4000000
#&gt; estimate 0.8224538 2.521749 0.8548858 0.4069159</div><div class='input'>
<span class='co'># Confusion matrix</span>
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span>(<span class='st'>"Khat"</span> = <span class='kw'>IDRs</span><span class='op'>$</span><span class='kw'>Khat</span>, <span class='st'>"K"</span> = <span class='kw'>data</span><span class='op'>$</span><span class='kw'>K</span>)
</div><div class='output co'>#&gt;     K
#&gt; Khat   1   2
#&gt;    1 797  37
#&gt;    2   5 161</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Anders Ellern Bilgrau.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.0.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


